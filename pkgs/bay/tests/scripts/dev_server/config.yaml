# Bay Dev Server config for debugging
#
# This config is used for local development and debugging.
# Container is NOT deleted after sandbox deletion to allow log inspection.
#
# Usage:
#   BAY_CONFIG_FILE=tests/scripts/dev_server/config.yaml uv run python -m app.main

server:
  host: "127.0.0.1"
  port: 8002  # Use different port to avoid conflicts

database:
  # Use separate dev database
  url: "sqlite+aiosqlite:///./bay-dev.db"
  echo: true  # Enable SQL logging for debugging

driver:
  type: docker
  docker:
    socket: "unix:///var/run/docker.sock"
    # Bay on host, Ship in container - use host port mapping
    connect_mode: host_port
    host_address: "127.0.0.1"
    publish_ports: true
    host_port: null  # Random port assignment
    network: null

cargo:
  root_path: "/var/lib/bay/cargos"
  default_size_limit_mb: 1024
  mount_path: "/workspace"

security:
  # Development mode: no API key required
  api_key: null
  allow_anonymous: true

profiles:
  - id: python-default
    image: "ship:latest"
    runtime_type: ship
    runtime_port: 8123
    resources:
      cpus: 1.0
      memory: "1g"
    capabilities:
      - filesystem  # includes upload/download
      - shell
      - python
    idle_timeout: 3600  # 1 hour for dev
    env: {}

  # Restricted profile for capability enforcement testing
  - id: python-only-test
    image: "ship:latest"
    runtime_type: ship
    runtime_port: 8123
    resources:
      cpus: 1.0
      memory: "1g"
    capabilities:
      - python  # Only python - no shell/filesystem access
    idle_timeout: 300
    env: {}
